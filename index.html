<!DOCTYPE html>
<html lang="en">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MP2ZZ8BZC4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-MP2ZZ8BZC4');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magic Countdown Clock</title>
    <div class="controls">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2850763844297109"
     crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@600;700&family=Chewy&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        :root {
            --primary: #FF6B9D;
            --secondary: #FEC601;
            --accent: #00D4FF;
            --bg: #FFF5F7;
        }
        body {
            font-family: 'Fredoka', sans-serif;
            background: linear-gradient(135deg, #FFE5EC 0%, #FFD1DC 50%, #FFC0CB 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }
        h1 {
            font-family: 'Chewy', cursive;
            font-size: clamp(2rem, 5vw, 3.5rem);
            color: var(--primary);
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 3px 3px 0 rgba(254, 198, 1, 0.3);
            animation: bounce 2s ease-in-out infinite;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 30px;
            align-items: center;
        }
        .color-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .color-btn {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.5rem;
            width: 50px;
            height: 50px;
            border: 4px solid #333;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 4px 4px 0 #333;
            transition: all 0.2s;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .color-btn:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 #333;
        }
        .color-btn:active {
            transform: translate(4px, 4px);
            box-shadow: 0 0 0 #333;
        }
        .preset-images {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .preset-btn {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.8rem;
            width: 60px;
            height: 60px;
            border: 4px solid #333;
            border-radius: 15px;
            cursor: pointer;
            box-shadow: 4px 4px 0 #333;
            transition: all 0.2s;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
        }
        .preset-btn:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 #333;
        }
        .preset-btn:active {
            transform: translate(4px, 4px);
            box-shadow: 0 0 0 #333;
        }
        button, input[type="file"]::file-selector-button {
            font-family: 'Fredoka', sans-serif;
            font-weight: 600;
            font-size: 1.1rem;
            padding: 15px 30px;
            border: 4px solid #333;
            border-radius: 50px;
            background: var(--secondary);
            color: #333;
            cursor: pointer;
            box-shadow: 6px 6px 0 #333;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        button:hover, input[type="file"]::file-selector-button:hover {
            transform: translate(2px, 2px);
            box-shadow: 4px 4px 0 #333;
        }
        button:active, input[type="file"]::file-selector-button:active {
            transform: translate(6px, 6px);
            box-shadow: 0 0 0 #333;
        }
        button.start {
            background: var(--accent);
        }
        button.pause {
            background: var(--primary);
            color: white;
        }
        input[type="file"] {
            border: 0;
        }
        .time-selector {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
        }
        input[type="text"] {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.2rem;
            font-weight: 600;
            padding: 10px 15px;
            border: 4px solid #333;
            border-radius: 20px;
            width: 120px;
            text-align: center;
            background: white;
        }
        input[type="text"]::placeholder {
            color: #999;
        }
        .countdown-display {
            font-family: 'Chewy', cursive;
            font-size: clamp(3rem, 10vw, 6rem);
            color: var(--primary);
            text-align: center;
            margin: 30px 0 10px 0;
            text-shadow: 4px 4px 0 rgba(0, 0, 0, 0.1);
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .timer-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }
        .clock-container {
            position: relative;
            width: min(500px, 90vw);
            height: min(500px, 90vw);
            margin: 0 auto;
        }
        .clock {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 8px solid #333;
            background: white;
            box-shadow: 
                0 0 0 12px var(--secondary),
                0 0 0 16px #333,
                0 20px 40px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        .clock-image {
            position: absolute;
            top: 10%;
            left: 10%;
            width: 80%;
            height: 80%;
            object-fit: cover;
            border-radius: 50%;
            z-index: 1;
            clip-path: polygon(50% 50%, 50% 0%, 50% 0%);
        }
        .clock-color {
            position: absolute;
            top: 10%;
            left: 10%;
            width: 80%;
            height: 80%;
            border-radius: 50%;
            z-index: 1;
            clip-path: polygon(50% 50%, 50% 0%, 50% 0%);
        }
        .clock-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 30px;
            height: 30px;
            background: var(--primary);
            border-radius: 50%;
            border: 4px solid #333;
            z-index: 10;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        .clock-hand {
            position: absolute;
            bottom: 50%;
            left: 50%;
            width: 6px;
            height: 45%;
            background: linear-gradient(to top, var(--primary), #FF1744);
            border-radius: 3px 3px 0 0;
            transform-origin: bottom center;
            transform: translateX(-50%) rotate(0deg);
            z-index: 9;
            box-shadow: 0 0 10px rgba(255, 107, 157, 0.5);
        }
        .placeholder {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Fredoka', sans-serif;
            font-size: 1.5rem;
            color: #999;
            text-align: center;
            z-index: 1;
            pointer-events: none;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .pulsing {
            animation: pulse 1s ease-in-out infinite;
        }
        .confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }
        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--primary);
            animation: confetti-fall 3s linear forwards;
        }
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
        .ad-container {
            width: 100%;
            max-width: 728px;
            margin: 30px auto 20px auto;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>üé® Magic Countdown Clock ‚ú®</h1>
    
    <div class="controls">
        <input type="file" id="imageUpload" accept="image/*">
        <div class="color-buttons">
            <button class="color-btn" data-color="#FF0000" style="background: #FF0000;" title="Red">üî¥</button>
            <button class="color-btn" data-color="#FF7F00" style="background: #FF7F00;" title="Orange">üü†</button>
            <button class="color-btn" data-color="#FFFF00" style="background: #FFFF00;" title="Yellow">üü°</button>
            <button class="color-btn" data-color="#00FF00" style="background: #00FF00;" title="Green">üü¢</button>
            <button class="color-btn" data-color="#0000FF" style="background: #0000FF;" title="Blue">üîµ</button>
            <button class="color-btn" data-color="#4B0082" style="background: #4B0082;" title="Indigo">üü£</button>
            <button class="color-btn" data-color="#9400D3" style="background: #9400D3;" title="Violet">üü£</button>
        </div>
        <div class="preset-images">
            <button class="preset-btn" data-preset="dog" title="Dog">üêï</button>
            <button class="preset-btn" data-preset="icecream" title="Ice Cream">üç¶</button>
            <button class="preset-btn" data-preset="firetruck" title="Fire Truck">üöí</button>
        </div>
        <div class="time-selector">
            <input type="text" id="timeInput" value="01:00" placeholder="MM:SS">
            <span style="font-size: 1.2rem; font-weight: 600; color: #333;">MM:SS</span>
        </div>
        <div style="display: flex; align-items: center; gap: 10px;">
            <input type="checkbox" id="quarterDings" style="width: 20px; height: 20px; cursor: pointer;">
            <label for="quarterDings" style="font-family: 'Fredoka', sans-serif; font-weight: 600; font-size: 1rem; color: #333; cursor: pointer;">Quarter Dings</label>
        </div>
        <button class="start" id="startBtn">Start!</button>
        <button class="pause" id="pauseBtn" style="display: none;">Pause</button>
    </div>
    
    <div class="timer-section">
        <div class="countdown-display" id="countdownDisplay">Ready!</div>
        <div class="clock-container">
            <div class="clock">
            <div class="placeholder" id="placeholder">Upload a picture or pick a color for your visual timer! üì∏üé®</div>
            <div class="clock-color" id="clockColor" style="display: none;"></div>
            <img class="clock-image" id="clockImage" style="display: none;">
            
            <div class="clock-hand" id="clockHand"></div>
            <div class="clock-center"></div>
        </div>
    </div>
    </div>
    <div class="confetti" id="confetti"></div>
    
    <div style="display: flex; justify-content: center; width: 100%;">
        <p style="max-width: 800px; text-align: center; margin: 30px auto 20px; font-size: 0.9rem; color: #555; line-height: 1.5;">
            Our visual timer makes time management fun and engaging! Perfect for kids, classrooms, and anyone who needs a colorful countdown clock. Upload your favorite photo or choose a rainbow color to watch your custom timer gradually reveal as time passes. This animated countdown timer helps children understand the passage of time visually, making it an ideal tool for homework sessions, study breaks, cooking timers, or classroom activities.
        </p>
    </div>
    
    <!-- Bottom Ad -->
    <div class="ad-container">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-2850763844297109"
             data-ad-slot="0987654321"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
    <script>
        let countdown = 60;
        let totalTime = 60;
        let isRunning = false;
        let intervalId = null;
        let imageLoaded = false;
        let colorMode = false;
        let startTime = null;
        let elapsedTime = 0;
        let quarterDingsPlayed = { 75: false, 50: false, 25: false };
        const imageUpload = document.getElementById('imageUpload');
        const clockImage = document.getElementById('clockImage');
        const clockColor = document.getElementById('clockColor');
        const placeholder = document.getElementById('placeholder');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const timeInput = document.getElementById('timeInput');
        const countdownDisplay = document.getElementById('countdownDisplay');
        const clockHand = document.getElementById('clockHand');
        const colorButtons = document.querySelectorAll('.color-btn');
        const presetButtons = document.querySelectorAll('.preset-btn');
        
        // SVG images for preset buttons
        const presetImages = {
            dog: `data:image/svg+xml,${encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><defs><linearGradient id="dogGrad" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#D2691E;stop-opacity:1" /><stop offset="100%" style="stop-color:#A0522D;stop-opacity:1" /></linearGradient></defs><ellipse cx="100" cy="115" rx="48" ry="38" fill="url(#dogGrad)"/><ellipse cx="85" cy="75" rx="28" ry="32" fill="url(#dogGrad)"/><ellipse cx="55" cy="70" rx="12" ry="22" fill="url(#dogGrad)" stroke="#8B4513" stroke-width="2"/><ellipse cx="115" cy="70" rx="12" ry="22" fill="url(#dogGrad)" stroke="#8B4513" stroke-width="2"/><ellipse cx="75" cy="72" rx="5" ry="6" fill="white"/><circle cx="75" cy="72" r="3" fill="black"/><ellipse cx="95" cy="72" rx="5" ry="6" fill="white"/><circle cx="95" cy="72" r="3" fill="black"/><ellipse cx="85" cy="85" rx="6" ry="5" fill="#8B4513"/><path d="M 85 90 Q 80 96 75 92 M 85 90 Q 90 96 95 92" stroke="black" stroke-width="2" fill="none"/><ellipse cx="130" cy="120" rx="20" ry="15" fill="url(#dogGrad)"/><path d="M 148 118 Q 165 115 170 125 Q 172 135 165 138 Q 160 140 155 132" fill="url(#dogGrad)" stroke="#8B4513" stroke-width="1.5"/><rect x="75" y="140" width="14" height="25" rx="3" fill="url(#dogGrad)"/><rect x="95" y="140" width="14" height="25" rx="3" fill="url(#dogGrad)"/><ellipse cx="82" cy="165" rx="8" ry="5" fill="#8B4513"/><ellipse cx="102" cy="165" rx="8" ry="5" fill="#8B4513"/></svg>`)}`,
            icecream: `data:image/svg+xml,${encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><defs><linearGradient id="coneGrad" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#F4D03F;stop-opacity:1" /><stop offset="100%" style="stop-color:#C8A520;stop-opacity:1" /></linearGradient><linearGradient id="strawGrad" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#FFB3D9;stop-opacity:1" /><stop offset="100%" style="stop-color:#FF8DC7;stop-opacity:1" /></linearGradient><linearGradient id="mintGrad" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#B8E6D5;stop-opacity:1" /><stop offset="100%" style="stop-color:#7FD8BE;stop-opacity:1" /></linearGradient><linearGradient id="vanillaGrad" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#FFF8DC;stop-opacity:1" /><stop offset="100%" style="stop-color:#FFEAA7;stop-opacity:1" /></linearGradient></defs><path d="M 75 105 L 100 175 L 125 105 Z" fill="url(#coneGrad)" stroke="#A68A1F" stroke-width="2"/><line x1="80" y1="115" x2="95" y2="150" stroke="#A68A1F" stroke-width="1.5"/><line x1="88" y1="115" x2="100" y2="160" stroke="#A68A1F" stroke-width="1.5"/><line x1="96" y1="115" x2="105" y2="155" stroke="#A68A1F" stroke-width="1.5"/><line x1="104" y1="115" x2="110" y2="145" stroke="#A68A1F" stroke-width="1.5"/><line x1="112" y1="115" x2="115" y2="135" stroke="#A68A1F" stroke-width="1.5"/><ellipse cx="100" cy="100" rx="32" ry="20" fill="url(#strawGrad)"/><ellipse cx="78" cy="75" rx="26" ry="18" fill="url(#mintGrad)"/><ellipse cx="122" cy="75" rx="26" ry="18" fill="url(#vanillaGrad)"/><ellipse cx="85" cy="78" rx="2.5" ry="4" fill="#CD5C5C" transform="rotate(15 85 78)"/><ellipse cx="92" cy="74" rx="2.5" ry="4" fill="#CD5C5C" transform="rotate(-10 92 74)"/><ellipse cx="100" cy="95" rx="2.5" ry="4" fill="#CD5C5C" transform="rotate(20 100 95)"/><ellipse cx="108" cy="98" rx="2.5" ry="4" fill="#CD5C5C" transform="rotate(-15 108 98)"/><ellipse cx="115" cy="74" rx="2.5" ry="4" fill="#8B4513" transform="rotate(10 115 74)"/><ellipse cx="128" cy="76" rx="2.5" ry="4" fill="#8B4513" transform="rotate(-20 128 76)"/><path d="M 100 105 Q 96 112 92 106" stroke="#FF69B4" stroke-width="1.5" fill="none"/></svg>`)}`,
            firetruck: `data:image/svg+xml,${encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><defs><linearGradient id="truckGrad" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#E63946;stop-opacity:1" /><stop offset="100%" style="stop-color:#C1121F;stop-opacity:1" /></linearGradient><linearGradient id="darkRedGrad" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#9D0208;stop-opacity:1" /><stop offset="100%" style="stop-color:#6A040F;stop-opacity:1" /></linearGradient></defs><rect x="35" y="85" width="130" height="50" fill="url(#truckGrad)" stroke="#9D0208" stroke-width="2" rx="3"/><rect x="45" y="65" width="45" height="28" fill="url(#truckGrad)" stroke="#9D0208" stroke-width="2" rx="2"/><rect x="52" y="70" width="14" height="16" fill="#B8E6F0" stroke="#4A90A4" stroke-width="1.5"/><rect x="72" y="70" width="14" height="16" fill="#B8E6F0" stroke="#4A90A4" stroke-width="1.5"/><rect x="110" y="95" width="18" height="22" fill="#FFD60A" stroke="#D4A017" stroke-width="1.5" rx="2"/><rect x="135" y="95" width="18" height="22" fill="#FFD60A" stroke="#D4A017" stroke-width="1.5" rx="2"/><circle cx="65" cy="140" r="13" fill="#2B2D42" stroke="#1A1B26" stroke-width="2"/><circle cx="65" cy="140" r="7" fill="#8D99AE"/><circle cx="140" cy="140" r="13" fill="#2B2D42" stroke="#1A1B26" stroke-width="2"/><circle cx="140" cy="140" r="7" fill="#8D99AE"/><rect x="98" y="48" width="10" height="40" fill="#4169E1" stroke="#1E3A8A" stroke-width="1.5" rx="2"/><rect x="96" y="46" width="14" height="8" fill="#EF233C" rx="2"/><rect x="99" y="50" width="3" height="4" fill="#FFD60A"/><path d="M 155 75 L 168 75 L 168 88 L 155 88 Z" fill="#FFD60A" stroke="#D4A017" stroke-width="1.5"/><rect x="157" y="78" width="3" height="8" fill="#FFA500"/><rect x="163" y="78" width="3" height="8" fill="#FFA500"/><line x1="35" y1="100" x2="165" y2="100" stroke="#9D0208" stroke-width="2"/><rect x="45" y="105" width="8" height="12" fill="url(#darkRedGrad)" rx="1"/><rect x="58" y="105" width="8" height="12" fill="url(#darkRedGrad)" rx="1"/></svg>`)}`
        };
        
        // Function to parse MM:SS format into seconds
        function parseTimeInput(value) {
            // Remove any whitespace
            value = value.trim();
            
            // Check if it matches MM:SS format
            const match = value.match(/^(\d+):(\d{2})$/);
            if (match) {
                const minutes = parseInt(match[1]);
                const seconds = parseInt(match[2]);
                if (seconds >= 60) {
                    alert('Seconds must be less than 60');
                    return null;
                }
                return minutes * 60 + seconds;
            }
            
            // Check if it's just a number (treat as seconds for backwards compatibility)
            const numMatch = value.match(/^\d+$/);
            if (numMatch) {
                return parseInt(value);
            }
            
            alert('Please enter time in MM:SS format (e.g., 01:30)');
            return null;
        }
        
        // Function to format seconds into MM:SS
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
        
        imageUpload.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    clockImage.src = event.target.result;
                    clockImage.style.display = 'block';
                    clockColor.style.display = 'none';
                    placeholder.style.display = 'none';
                    imageLoaded = true;
                    colorMode = false;
                    elapsedTime = 0;
                    resetClock();
                };
                reader.readAsDataURL(file);
            }
        });
        colorButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                const color = btn.getAttribute('data-color');
                clockColor.style.backgroundColor = color;
                clockColor.style.display = 'block';
                clockImage.style.display = 'none';
                placeholder.style.display = 'none';
                imageLoaded = true;
                colorMode = true;
                elapsedTime = 0;
                resetClock();
            });
        });
        
        presetButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                const preset = btn.getAttribute('data-preset');
                clockImage.src = presetImages[preset];
                clockImage.style.display = 'block';
                clockColor.style.display = 'none';
                placeholder.style.display = 'none';
                imageLoaded = true;
                colorMode = false;
                elapsedTime = 0;
                resetClock();
            });
        });
        
        timeInput.addEventListener('change', () => {
            if (!isRunning) {
                const parsedTime = parseTimeInput(timeInput.value);
                if (parsedTime !== null && parsedTime > 0) {
                    totalTime = parsedTime;
                    countdown = totalTime;
                    elapsedTime = 0;
                    quarterDingsPlayed = { 75: false, 50: false, 25: false };
                    // Update the input to show proper MM:SS format
                    timeInput.value = formatTime(totalTime);
                    updateDisplay();
                    resetClock();
                } else if (parsedTime === 0) {
                    alert('Time must be greater than 0');
                    timeInput.value = formatTime(totalTime);
                } else {
                    // Invalid input, reset to current totalTime
                    timeInput.value = formatTime(totalTime);
                }
            }
        });
        
        // Also validate on blur
        timeInput.addEventListener('blur', () => {
            if (!isRunning) {
                const parsedTime = parseTimeInput(timeInput.value);
                if (parsedTime !== null && parsedTime > 0) {
                    totalTime = parsedTime;
                    countdown = totalTime;
                    quarterDingsPlayed = { 75: false, 50: false, 25: false };
                    timeInput.value = formatTime(totalTime);
                    updateDisplay();
                    resetClock();
                } else {
                    timeInput.value = formatTime(totalTime);
                }
            }
        });
        
        startBtn.addEventListener('click', () => {
            if (!isRunning) {
                if (countdown === 0) {
                    countdown = totalTime;
                    elapsedTime = 0;
                    resetClock();
                }
                quarterDingsPlayed = { 75: false, 50: false, 25: false };
                isRunning = true;
                startBtn.style.display = 'none';
                pauseBtn.style.display = 'inline-block';
                startCountdown();
            }
        });
        pauseBtn.addEventListener('click', () => {
            isRunning = false;
            clearInterval(intervalId);
            pauseBtn.style.display = 'none';
            startBtn.style.display = 'inline-block';
            startBtn.textContent = 'Resume';
        });
        function startCountdown() {
            startTime = Date.now() - (elapsedTime * 1000);
            
            intervalId = setInterval(() => {
                const now = Date.now();
                const totalElapsed = (now - startTime) / 1000; // in seconds
                const remaining = totalTime - totalElapsed;
                
                if (remaining > 0) {
                    countdown = Math.ceil(remaining);
                    elapsedTime = totalElapsed;
                    updateDisplay();
                    updateClockSmooth(totalElapsed);
                    
                    // Check for quarter dings
                    const quarterDingsCheckbox = document.getElementById('quarterDings');
                    if (quarterDingsCheckbox.checked) {
                        const progress = (totalElapsed / totalTime) * 100;
                        
                        if (progress >= 25 && !quarterDingsPlayed[75]) {
                            quarterDingsPlayed[75] = true;
                            playQuarterDing();
                        } else if (progress >= 50 && !quarterDingsPlayed[50]) {
                            quarterDingsPlayed[50] = true;
                            playQuarterDing();
                        } else if (progress >= 75 && !quarterDingsPlayed[25]) {
                            quarterDingsPlayed[25] = true;
                            playQuarterDing();
                        }
                    }
                } else {
                    countdown = 0;
                    elapsedTime = totalTime;
                    isRunning = false;
                    clearInterval(intervalId);
                    pauseBtn.style.display = 'none';
                    startBtn.style.display = 'inline-block';
                    startBtn.textContent = 'Start!';
                    updateDisplay();
                    updateClockSmooth(totalTime);
                    celebrate();
                }
            }, 50); // Update 20 times per second for smooth animation
        }
        function updateDisplay() {
            const minutes = Math.floor(countdown / 60);
            const seconds = countdown % 60;
            if (countdown === 0) {
                countdownDisplay.innerHTML = 'üéâ Done! üéâ';
                countdownDisplay.classList.add('pulsing');
            } else {
                countdownDisplay.classList.remove('pulsing');
                if (minutes > 0) {
                    countdownDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                } else {
                    countdownDisplay.textContent = `${seconds}`;
                }
            }
        }
        function updateClockSmooth(elapsedSeconds) {
            const progress = Math.min(elapsedSeconds / totalTime, 1);
            const degrees = progress * 360;
            
            // Update clock hand
            clockHand.style.transform = `translateX(-50%) rotate(${degrees}deg)`;
            
            // Update image/color reveal - radial fill following the clock hand
            if (imageLoaded) {
                const activeElement = colorMode ? clockColor : clockImage;
                
                // If complete, show entire image/color
                if (progress >= 1) {
                    activeElement.style.clipPath = 'none';
                } else {
                    const angle = degrees;
                    const rad = (angle - 90) * Math.PI / 180;
                    // Use radius of 150 (3x) to extend well beyond boundaries
                    let x = Math.round((50 + 150 * Math.cos(rad)) * 10) / 10;
                    let y = Math.round((50 + 150 * Math.sin(rad)) * 10) / 10;
                    x = Math.max(-100, Math.min(200, x));
                    y = Math.max(-100, Math.min(200, y));
                    
                    // Create a pie wedge that grows clockwise from top
                    if (angle < 90) {
                        activeElement.style.clipPath = `polygon(50% 50%, 50% -100%, ${x}% ${y}%)`;
                    } else if (angle < 180) {
                        activeElement.style.clipPath = `polygon(50% 50%, 50% -100%, 200% -100%, ${x}% ${y}%)`;
                    } else if (angle < 270) {
                        activeElement.style.clipPath = `polygon(50% 50%, 50% -100%, 200% -100%, 200% 200%, ${x}% ${y}%)`;
                    } else if (angle < 360) {
                        activeElement.style.clipPath = `polygon(50% 50%, 50% -100%, 200% -100%, 200% 200%, -100% 200%, ${x}% ${y}%)`;
                    }
                }
            }
        }
        function updateClock() {
            const progress = 1 - (countdown / totalTime);
            const degrees = progress * 360;
            
            // Update clock hand
            clockHand.style.transform = `translateX(-50%) rotate(${degrees}deg)`;
            
            // Update image/color reveal - radial fill following the clock hand
            if (imageLoaded) {
                const activeElement = colorMode ? clockColor : clockImage;
                
                // If complete, show entire image/color
                if (progress >= 1) {
                    activeElement.style.clipPath = 'none';
                } else {
                    const angle = degrees;
                    const rad = (angle - 90) * Math.PI / 180;
                    // Use radius of 150 (3x) to extend well beyond boundaries
                    let x = Math.round((50 + 150 * Math.cos(rad)) * 10) / 10;
                    let y = Math.round((50 + 150 * Math.sin(rad)) * 10) / 10;
                    x = Math.max(-100, Math.min(200, x));
                    y = Math.max(-100, Math.min(200, y));
                    
                    // Create a pie wedge that grows clockwise from top
                    if (angle < 90) {
                        activeElement.style.clipPath = `polygon(50% 50%, 50% -100%, ${x}% ${y}%)`;
                    } else if (angle < 180) {
                        activeElement.style.clipPath = `polygon(50% 50%, 50% -100%, 200% -100%, ${x}% ${y}%)`;
                    } else if (angle < 270) {
                        activeElement.style.clipPath = `polygon(50% 50%, 50% -100%, 200% -100%, 200% 200%, ${x}% ${y}%)`;
                    } else if (angle < 360) {
                        activeElement.style.clipPath = `polygon(50% 50%, 50% -100%, 200% -100%, 200% 200%, -100% 200%, ${x}% ${y}%)`;
                    }
                }
            }
        }
        function resetClock() {
            elapsedTime = 0;
            clockHand.style.transform = 'translateX(-50%) rotate(0deg)';
            if (imageLoaded) {
                const activeElement = colorMode ? clockColor : clockImage;
                activeElement.style.clipPath = 'polygon(50% 50%, 50% 0%, 50% 0%)';
            }
            updateDisplay();
        }
        function celebrate() {
            // Play alarm sound
            playAlarmSound();
            
            const confetti = document.getElementById('confetti');
            const colors = ['#FF6B9D', '#FEC601', '#00D4FF', '#FF1744', '#00E676'];
            
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const piece = document.createElement('div');
                    piece.className = 'confetti-piece';
                    piece.style.left = Math.random() * 100 + '%';
                    piece.style.background = colors[Math.floor(Math.random() * colors.length)];
                    piece.style.animationDelay = Math.random() * 0.5 + 's';
                    confetti.appendChild(piece);
                    
                    setTimeout(() => piece.remove(), 3000);
                }, i * 30);
            }
        }
        function playAlarmSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const startTime = audioContext.currentTime;
            
            // Create a long, sustained chime with harmonics
            const frequencies = [800, 1200]; // Fundamental and harmonic
            
            frequencies.forEach((freq, index) => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = freq;
                oscillator.type = 'sine';
                
                // Long sustained chime - quick attack, long sustain, gradual decay
                const volume = index === 0 ? 0.4 : 0.2; // Main tone louder than harmonic
                gainNode.gain.setValueAtTime(0, startTime);
                gainNode.gain.linearRampToValueAtTime(volume, startTime + 0.02);
                gainNode.gain.setValueAtTime(volume, startTime + 0.5);
                gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + 2.5);
                
                oscillator.start(startTime);
                oscillator.stop(startTime + 2.5);
            });
        }
        
        function playQuarterDing() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const startTime = audioContext.currentTime;
            
            // Create a shorter, higher-pitched ding
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 1000; // Higher pitch
            oscillator.type = 'sine';
            
            // Short ding
            gainNode.gain.setValueAtTime(0, startTime);
            gainNode.gain.linearRampToValueAtTime(0.3, startTime + 0.01);
            gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + 0.3);
            
            oscillator.start(startTime);
            oscillator.stop(startTime + 0.3);
        }
        updateDisplay();
    </script>
</body>
</html>
